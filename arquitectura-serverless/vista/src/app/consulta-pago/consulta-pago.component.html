<div>

  <mat-toolbar>
    <mat-toolbar-row color="primary"><span class="title">{{title}}</span></mat-toolbar-row>
  </mat-toolbar>

  <!--  Búsqueda -->

  <div *ngIf="paso == 1">
    <form (ngSubmit)="consultar()" [formGroup]="form">
      <h1>Búsqueda</h1>
      <div class="col-md-6">
        <ul id="params" formArrayName="identificadores">
          <div class="row" *ngFor="let e of form.get('identificadores')['controls']; let i = index">
            <div formGroupName="{{i}}" class="form-group">
              <!-- INPUT -->
              <mat-form-field>
                <input matInput
                       placeholder="{{e.value.nombre}}"
                       required
                       type="text"
                       maxlength="80"
                       formControlName="valor">
              </mat-form-field>
            </div>
          </div>
        </ul>
      </div>
      <div>
        <button [disabled]="!form.valid" type="submit" mat-raised-button>Buscar
        </button>
      </div>
    </form>
  </div>

  <!--  Selección de Cuenta -->

  <div *ngIf="paso == 2">
    <form  (ngSubmit)="pagar()" [formGroup]="formPay">
      <h1>Seleccionar cuenta para realizar pago</h1>
      <div class="row" *ngFor="let e of form.get('identificadores')['controls']; let i = index">
        <h3> {{e.value.nombre}}: {{e.value.valor}}</h3>
      </div>
      <div class="col-md-6">
        <h3>Total a Pagar: Q. {{saldo}}</h3>
        <mat-form-field>
          <mat-select placeholder="Cuenta" formControlName="cuenta">
            <mat-option *ngFor="let cuenta of cuentas" [value]="cuenta.numero">
              {{cuenta.numero + " - " + cuenta.alias}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <div>
          <button [disabled]="!formPay.valid" type="submit" mat-raised-button>Pagar</button>
        </div>
      </div>
    </form>
  </div>

  <!--  Confirmación -->

  <div *ngIf="paso == 3">
    <form (ngSubmit)="confirmarPago()">
      <h1>Está seguro de realizar el pago?</h1>
      <div class="row" *ngFor="let e of form.get('identificadores')['controls']; let i = index">
        <h3> {{e.value.nombre}}: {{e.value.valor}}</h3>
      </div>
      <h3>Total a Pagar: {{saldo}}</h3>
      <h3>Cuenta: {{cuenta.numero + ' - ' + cuenta.alias}}</h3>
      <button [disabled]="!formPay.valid" type="submit" mat-raised-button>Confirmar Pago</button>
    </form>
  </div>

  <div *ngIf="paso == 4">
    <form>
      <h1>Pago realizado exitosamente!</h1>
      <div class="row" *ngFor="let e of form.get('identificadores')['controls']; let i = index">
        <h3> {{e.value.nombre}}: {{e.value.valor}}</h3>
      </div>
      <h3>Cuenta: {{cuenta.numero + ' - ' + cuenta.alias}}</h3>
      <h3>Total: {{saldo}}</h3>
      <h3>Referencia de Pago: {{idPago}}</h3>

      <button [routerLink]="['/favorito/' + servicio]" [queryParams]="identificadoresUsados" *ngIf="!this.favorito" mat-raised-button>Guardar Favorito</button>
      <button [routerLink]="['/']" mat-raised-button>Continuar</button>
    </form>
  </div>

</div>
